<html lang="en">
<head>
<title>GIOP functions - PolyORB-HI-C User's Guide</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="PolyORB-HI-C User's Guide">
<meta name="generator" content="makeinfo 4.8">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="PolyORB_002dHI_002dC-API.html#PolyORB_002dHI_002dC-API" title="PolyORB-HI-C API">
<link rel="prev" href="Marshallers-functions.html#Marshallers-functions" title="Marshallers functions">
<link rel="next" href="Messages-functions.html#Messages-functions" title="Messages functions">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 2007-2009, E'cole nationale supe'rieure des
te'lc'ommunications

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.1 or
any later version published by the Free Software Foundation; with the
Invariant Sections being ``GNU Free Documentation License'', with the
Front-Cover Texts being ``PolyORB High Integrity C User's Guide'', and
with no Back-Cover Texts.  A copy of the license is included in the
section entitled ``GNU Free Documentation License''.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
body {}
body {
	background-color: white;
	position: absolute;
	font-size: medium;
	font-family: Verdana;
//	padding-left: 7em;
	top: 3em;
}

div.navigation {
	font-size: small; 
	padding-left: 0; 
	padding-right: 0; 
	text-align: right
}

div#menu {
	text-align: left;
	position: fixed;
	left: 1pt;
	bottom: auto;
	top: 2em;
	right: auto;
	padding-right: 1ex;
	padding-left: 1em;
	padding-top: 1ex;
	padding-bottom: 1ex;
	border-width: 3pt;
	background-color: transparent;  
	border-color: red; 
	border-left-style: solid
}

div#menu span.item {
	display: block;
	background-color: transparent;  
}

table.navigation {
	font-size: small
} 


/* Paragraphs */
p, blockquote {
	color: black; 
	text-indent: 1em; 
	text-align: justify
}


p {
	margin-bottom: .5em; 
	margin-top: 1px
}

p kbd 
{
  background-color: ivory
}

div.important {
	background-color: lightgray; 
	border-color: red; 
	border-style: solid;  
	border-width: 1pt
}
p.important {
	color: red
}
p.brut {
	text-indent: 0
}
p.brut:first-letter {
	font-size: 100%; 
	font-weight: normal
}

/* Sections */
div {
	border-style: none; 
	padding-left: 1em; 
	padding-right: 1em; 
	margin-top: 2px; 
	margin-bottom: 2px
}


/* Menus */

div.action {
	background-color: ivory; 
	border-color: lightgray; 
	border-style: solid; 
	border-width: 1pt 1pt 1pt 1pt; 
	font-size: small; 
	text-align: left
}

div.special 
{
  border-color: lightgray; 
  border-style: solid; 
  border-width: 0 0 0 4pt
}


/* Docbook special settings */

h3.subtitle {
	text-align: center
}

h1.title {
	margin-bottom: 10pt;
}

div.authorgroup {
	margin-top: 2em;
	margin-bottom: 2em;
	text-align: center;
	display: block;
}

div.author {
	display: inline;
}

h3.author {
	display: inline;
	font-style: normal;
	color: black;
	font-size: medium;
}

p.copyright {
	margin-top: 1em;
	text-align: center;
}

/* End docbook settings */


/* hors-texte */

pre {
	background-color: whitesmoke;
	border-color: lightcoral;
	border-style: solid;
	border-width: 0pt 1pt 1pt 0pt;
}

.hors-texte {
	background-color: lightgray;  
	border-color: lightcoral; 
	border-style: solid;
	border-width: 1pt; 
	padding-left: 1em; 	
	padding-right: 1em; 
	text-align: justify
}

/* Tables */

table.hors-texte {
	margin: auto; 
	font-size: 100%;
	border-width: 1pt 1pt 1pt 1pt
}

table.hors-texte td {
	padding-left: 1ex; 
	padding-right: 1ex
}

table.hors-texte tr.sep {
	padding-top: 1ex
}


h1, h2, h3, h4, h5, h6 
{
  color: black; 
  text-decoration: none; 
  font-weight: bold;
  padding: 0pt
}

h1 {
	font-size: larger larger larger;
	text-align: center; 
	margin-bottom: 24pt
}
h2 {
	font-size: larger larger;
	margin-left:      0; 
	margin-top:       24pt; 
	margin-bottom:    14pt;
	border-color:     red;
	border-bottom-style:     solid;
	border-width:     1pt;
	padding:          2pt; 
	margin-left:      0; 
	margin-right:     0; 
}
h3 {
	font-size: larger;
	margin-left: 1em; 
	margin-bottom: 1ex;
	color: red;	
}
h4, h5, h6 {
	font-size: normal;
	margin-left: 2em; 
	margin-bottom: 1em
}

h4 {
	text-decoration: underlined
}
h5 {
	font-style: italic
}


h2.special 
{
  border-style:     solid;
  border-width:	    1pt;
  border-color:     lightgray;
  padding:          2pt; 
}

img.flottant {
	float: right;
	clear: both;
	margin: 2em;
}

/* Lists */

li, dd 
{
  text-align: justify
}

dt {
	font-style: normal; 
	margin-top: 1em
}
dd {
	font-style: normal; 
	margin-left: 4em
}

dd.sdd {
	margin-left: 5em
}

dd ul {margin-top: 0}
li dl {margin-top: 0}
ul {list-style-type: square}
ul ul {list-style-type: disc}
ul ul ul {list-style-type: circle}

/* Addresses */

address {
	margin-top: 1ex; margin-bottom: 1ex
}
address.poste {
	font-style: italic
}
address.email {
	font-style: normal
}
address.phone {
	font-style: oblic
}

/* Links */

a:link, a:visited {
	color: darkred;
	text-decoration: none;
	border-bottom-width: 1px;
	border-bottom-style: dotted;
	border-bottom-color:  red;
	padding-bottom: 0px
}

a:hover, a:active {
	color: red; 
	text-decoration: none;
	border-bottom-color: black;
	border-bottom-style: solid
}

--></style>
</head>
<body>
<div class="node">
<p>
<a name="GIOP-functions"></a>
Next:&nbsp;<a rel="next" accesskey="n" href="Messages-functions.html#Messages-functions">Messages functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Marshallers-functions.html#Marshallers-functions">Marshallers functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="PolyORB_002dHI_002dC-API.html#PolyORB_002dHI_002dC-API">PolyORB-HI-C API</a>
<hr>
</div>

<h3 class="section">C.4 <code>po_hi_giop.h</code></h3>

<!--  -->
<pre class="smallexample">     
     /*
      * This is a part of PolyORB-HI-C distribution, a minimal
      * middleware written for generated code from AADL models.
      * You should use it with the Ocarina toolsuite.
      *
      * For more informations, please visit http://ocarina.enst.fr
      *
      * Copyright (C) 2007-2009, GET-Telecom Paris.
      */
     
     #ifdef __PO_HI_USE_GIOP
     
     #ifndef __PO_HI_GIOP_H__
     #define __PO_HI_GIOP_H__
     
     #include &lt;po_hi_types.h&gt;
     #include &lt;po_hi_messages.h&gt;
     #include &lt;deployment.h&gt;
     #include &lt;string.h&gt;
     
     /*
      * This file defines the <b>struct</b>ures and functions to support the GIOP
      * protocol. The supported verrsion of GIOP is the 1.3.
      *
      * This implementation was made according to the CORBA 3.1, Part 2,
      * chapter 9 specifications.
      */
     
     #define __PO_HI_GIOP_MSGTYPE_REQUEST            0
     #define __PO_HI_GIOP_MSGTYPE_REPLY              1
     #define __PO_HI_GIOP_MSGTYPE_CANCELREQUEST      2
     #define __PO_HI_GIOP_MSGTYPE_LOCATEREQUEST      3
     #define __PO_HI_GIOP_MSGTYPE_LOCATEREPLY        4
     #define __PO_HI_GIOP_MSGTYPE_CLOSECONNECTION    5
     #define __PO_HI_GIOP_MSGTYPE_MESSAGEERROR       6
     #define __PO_HI_GIOP_MSGTYPE_FRAGMENT           7
     
     #define __PO_HI_GIOP_VERSION_MAJOR              1
     #define __PO_HI_GIOP_VERSION_MINOR              3
     
     #define __PO_HI_GIOP_MAGIC                      "<i>GIOP</i>"
     
     #define __PO_HI_GIOP_OPERATION_MAX_SIZE         100
     
     #define __PO_HI_GIOP_MAGIC_SIZE                 4
     
     #define __PO_HI_GIOP_DISPOSITION_KEY            0
     #define __PO_HI_GIOP_DISPOSITION_PROFILE        1
     #define __PO_HI_GIOP_DISPOSITION_REFERENCE      2
     
     #define __PO_HI_GIOP_HAS_MORE_MESSAGES          300
     
     <b>typedef</b> <b>struct</b>
     {
       <b>char</b>              magic[4];
       <b>struct</b> {
         __po_hi_uint8_t major; /* __PO_HI_GIOP_VERSION_MAJOR */
         __po_hi_uint8_t minor; /* __PO_HI_GIOP_VERSION_MINOR */
       } version;
       __po_hi_uint8_t   flags;
       __po_hi_uint8_t   message_type;
       __po_hi_uint32_t  message_size;
     }__po_hi_giop_msg_hdr_t;
     
     /* The __po_hi_giop_msg_hdr_t gives a <b>struct</b>ure to fill a message header */
     /* for the GIOP protocol. The flags (8 bits) are organized like this :   */
     /*  0  0  0  0  0  0  0  0                                               */
     /*                    |  |----- <i>byte order : 1 for little-endian         */</i>
     /*                    |                      0 for big-endian            */
     /* The message_type should be a value of __PO_HI_GIOP_MSGTYPE*           */
     
     <b>typedef</b> <b>struct</b>
     {
       __po_hi_uint16_t               disposition;
       <b>union</b>
       {
         <b>struct</b>
         {
           __po_hi_uint32_t               object_size;
           __po_hi_uint32_t               object_addr;
         }key;
     
         <b>struct</b>
         {
           __po_hi_uint32_t               profile_id;
           __po_hi_uint32_t               profile_length;
           __po_hi_uint32_t               profile_data;
         }profile;
     
         <b>struct</b>
         {
           __po_hi_uint32_t               profile_index;
           __po_hi_uint32_t               full_ior;
         }reference;
       } values;
     }__po_hi_giop_request_target_t;
     /*
      * Note: for now, we only support object target. The object-id will
      * always be set to 0.
      */
     
     <b>typedef</b> <b>struct</b>
     {
             __po_hi_uint32_t               request_id;
             __po_hi_uint8_t                response_flags;
             __po_hi_uint8_t                reserved[3];
             __po_hi_giop_request_target_t  target;
             __po_hi_uint32_t               operation_length;
             <b>char</b>                           operation[__PO_HI_GIOP_OPERATION_MAX_SIZE];
             __po_hi_uint32_t               nb_scontext;
     }__po_hi_giop_request_hdr_t;
     /*
      * The operation is set the a maximum length of 100
      */
     
     <b>void</b> __po_hi_giop_msg_hdr_init (__po_hi_giop_msg_hdr_t* msg_hdr);
     /*
      * Initialize the message header, set the magic number, the version
      * and all other needed variables
      */
     
     <b>void</b> __po_hi_giop_msg_hdr_set_message_type (__po_hi_giop_msg_hdr_t* msg_hdr,
                                                 __po_hi_uint8_t msg_type);
     /*
      * Set the message type in the header. We only support request, so the
      * type should be always __PO_HI_GIOP_MSG_REQUEST
      */
     
     <b>void</b> __po_hi_giop_msg_hdr_set_message_size (__po_hi_giop_msg_hdr_t* msg_hdr,
                                                 __po_hi_uint32_t msg_size);
     
     <b>void</b> __po_hi_giop_request_hdr_init (__po_hi_giop_request_hdr_t* request_hdr);
     
     <b>void</b> __po_hi_giop_request_hdr_set_operation (__po_hi_giop_request_hdr_t* request_hdr,
                                                  const <b>char</b>* request_name);
     
     <b>int</b> __po_hi_giop_send (__po_hi_entity_t from,
                            __po_hi_entity_t to,
                            __po_hi_msg_t*   msg);
     
     <b>int</b> __po_hi_giop_decode_msg (__po_hi_msg_t* network_flow,
                                  __po_hi_msg_t* output_msg,
                                  __po_hi_uint32_t* has_more);
     
     #ifdef __PO_HI_DEBUG
     <b>void</b> __po_hi_giop_print_msg( __po_hi_msg_t* msg);
     #endif
     
     #endif /* __PO_HI_GIOP_H__ */
     
     #endif /* __PO_HI_USE_GIOP */
     
</pre>
<!--  -->
</body></html>

